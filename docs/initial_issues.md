# Issue Compilation

This file serves as a compilation of the initial requirements for the project, all the information found here can also be found in the issues on the github.

## Representation of Agents

All car agents should follow the same rules of the road and have the same behaviour. They should be easily distinguishable from other objects in the environment (the road and other agents). Cars follow traffic rules on the road, therefore to behave as law-abiding road users in the simulation. As the initial minimum requirement will operate with only one single agent there will be no consideration of traffic.

The initial basic rules of the road include the following:
- A one-way road means one direction always.
- Cars can only drive on the right-hand lane of any two-lane road.
- Cars cannot U-turn on roads.
- Cars cannot leave roads.
- Cars travel at a fixed maximum speed when moving with no traffic.

### Success Criteria

- [ ] Car agents should be visually distinct from the road and environment.
- [ ] Car agents should follow the rules of the road.
- [ ] Car agents travel at a fixed maximum speed when moving with no traffic

### Risk Assessment

These requirements are believed to be easily achievable and a lightweight operation in the initial prototype model.

## Stochastic Spawning of Agents

Agents should spawn at a random point on the map and should be assigned a random point on the map to travel to. In the future, the project should introduce weighted probabilities for certain locations (such as shops and offices) to influence the agent's travel decisions. However, for the MVP, this is considered a secondary requirement and is not a priority at this stage. Therefore a random spawn and destination assignment is necessary. Following the initial requirements, a successful prototype would mean that in each run the agent would spawn at a random position on a random road on the map.

### Success Criteria

- [ ] Car agents should spawn in a random location.
- [ ] Car agents should have a random target destination.

### Risk Assessment

The risks for this section are neither high impact nor high likelihood.

## Agent Pathfinding

Once a source and destination point have been generated by the simulation, a path-finding algorithm should calculate, from the map, the fastest possible path from source to destination points. If an agent is to spawn to an area of the map where the path is not possible, the agent should respawn using the agent spawning algorithm.

- [ ] The pathfinding algorithm should be able to generate the shortest path between two points.
    - The fastest path is based on a Dijkstra-based shortest path algorithm. [^2]
    - There is no traffic in the prototype, therefore the car travels at its maximum speed whilst moving. 
- [ ] The pathfinding algorithm should follow all established rules of the road.
- [ ] The pathfinding algorithm should be able to determine whether a path is possible or not.
- [ ] Information from the pathfinding algorithm should be stored for statistical use.

### Risk Assessment

**Complex Implementation**
- Impact: *Medium*
    - Agent pathfinding problems can be solved given more time, so impact will not be high.
- Likelihood: *High*
    - Given initial research, agent pathfinding uses Djikstra-based algorithms, which are anticipated to be complex to implement.
- Mitigation:
    - Give more time for implementation of agent pathfinding when allocating workloads to MVP requirements.

## User Interaction

When agents can spawn randomly and pathfind effectively, the user should be able to block off roads of their choice, preventing agents from using the road sections that have been blocked. The user should also be able to unblock roads, such that they can test the simulation with different configurations. This could be done by just disabling an entire road section for now. This would be done before a simulation run starts, not during a run.

### Success Criteria

- [ ] Users should be able to block road sections.
- [ ] Users should be able to unblock road sections.
- [ ] Blocked road sections should not be usable by agents.
- [ ] Accessible method for the user to interact with the block/unblock road function.

### Risk Assessment

The risks for this section are neither high impact nor high likelihood.

## Simple Map

The MVP requirements for the road map should facilitate all other MVP requirements of the simulation whilst remaining a manageable size and maintaining simplicity that a prototype user can understand and easily debug. The roads should accommodate agents' functionality and have lanes assigned with one direction of travel that is communicated with the agents.

The roads should be arranged to have one T junction (two roads meet at a right angle), one cross junction (two roads intersect each other) and at least one one-way road (a car can only enter at one end, exit at the other, and travels in one direction). This will give a diversity of travel situations for an agent navigating the map from source to destination. [^1]

### Success Criteria

- [ ] The map should have a functional and visible representation of roads.
- [ ] The roads should accommodate functionality of car agents.
- [ ] The roads should have lanes with one direction of travel.
- [ ] The map should have one T junction.
- [ ] The map should have one cross junction.
- [ ] The map should have one one way road.
- [ ] The map should be shown from a birds-eye view.
- [ ] The map should be as small as possible while fulfilling all other criteria.


### Risk Assessment

The risks for this section are neither high impact nor high likelihood.

## Production of Statistical / Graphical Results

Statistical results from the simulation should show some key representations of the state of travel on the map as well as the consequences of blocking roads on traffic.

Due to the nature of the initial requirements of the MVP, the complexity of the statistics available are low. Travel time of the agent from source to destination can be measured with a system clock. From agent travel times, total and average air pollution can be derived using sourced statistics. Travel restrictions of residents can also be inferred from the number of times the simulation was forced to respawn an agent due to pathfinding failure.

- [ ] The simulation should collect key information as it runs.
- [ ] The simulation should calculate statistical data, which can be visualised in a graph.
- [ ] The simulation should visualise traffic moving on the map during simulation runtime.

### Risk Assessment

The risks for this section are neither high impact nor high likelihood.

## Block Roads at Specific Points

The ability to block roads at specific points is key for the final simulation, as it is used user interaction, pedestrian crossings, traffic lights and potentially other things.

- [ ] User interaction with the map is more exact.
- [ ] Pedestrian crossings on specified points on the road block agents when in use.
- [ ] Traffic lights can also use this as their way of stopping traffic.

### Risk Assessment

**Complex Implementation**
- Impact: *High*
    - Without the ability to block roads at certain points, other parts of the simulation cannot be implemented.
- Likelihood: *Low*
    - Considering a graph-based implementation, blocking a road at a point should be as simple as creating a new node on the graph.
- Mitigation:
    - Make sure when Final Prototype Underway (CA3) begins, this is a top priority for completion.
 
 ## Variety of Agents

 For the final simulation to be accurate, realistic, and produce good results, other types of agents must be added to the system.

- [ ] Car agent produced.
- [ ] Bus agent produced.
- [ ] Bike agent produced.
- [ ] Pedestrian agent produced.

### Risk Assessment

**Complex Implementation**
- Impact: *High*
    - If the model cannot simulate multiple types of agents, it will not be an accurate simulation.
- Likelihood: *Medium*
    - The introduction of new agents will take a lot of coding time, and be complex given different agents have completely different behaviour.
- Mitigation:
    - Make sure when producing the initial car agent that it can be changed / updated for the new agents.  If this is not done, rewrite the code for the car agent before implementing the other agents.
 
## Variety of Lanes and Road Rules

To facilitate the new agents and add realism, the following lanes and road rules should be added.

- [ ] Bus Lane where only buses may travel.
- [ ] Cycle Lane where only cyclists may travel.
- [ ] Pavement where only pedestrians may travel.
- [ ] Speed Limits on lanes may differ in areas.

### Risk Assessment

The risks for this section are neither high impact nor high likelihood.

## Complexity of Agent Travel

To make the simulation more realistic, it should take into account factors like people having locations they go to more often, such as their home or work.

- [ ] The original 'home' location of the agent is kept until return.
- [ ] Weighted destination locations, popular locations will have a greater visitor numbers.

### Risk Assessment

**Adding Complexity to Agent Pathfinding**
- Impact: *Medium*
    - Agents may take erroneous or not ideal routes to their destinations.
- Likelihood: *High*
    - With each agent taking multiple traffic and road restrictions into consideration during path finding it is open for error.
- Mitigation:
    - Similar to agent path finding, give more time for an agent to make a decision before spawning into the map.
    - Accept that the complexity of traffic means that a resident travelling through an area cannot always make the perfect decision.
 
## Heavitree Map Completed

In order to be of use to people in Heavitree, Exeter City Council and the RAMM, a map of Heavitree should be recreated in the simulation.

- [ ] The road layout of Heavitree should be finished.
- [ ] The buildings in Heavitree should be modelled.

### Risk Assessment

**Computationally Expensive to Run**
- Impact: *High*
    - Running the simulation on a map this large and dense may slow the runtime down to a halt.
- Likelihood: *Medium*
    - It is difficult to predict how Unity will run on a large scale map.
- Mitigation:
    - Run the simulation on parts of the map separately.
 
## Statistical Results and Analysis

Some statistical results should be able to be drawn from the simulation, including:
- [ ] Car travel times.
- [ ] Number of each type of agent.
- [ ] Traffic levels.
- [ ] Pollution.
- [ ] These results should be analysed and visualised.
- [ ] These results should be both local and global.

### Risk Assessment

**Cluttered User Interface**
- Impact: *High*
     - The user interface must be presentable and understandable for the user.
     - A cluttered interface would be an information overload for users.
- Likelihood: *Low*
    - There are very few features in the user interface that would lead to a cluttered UI and disorganised UX.
- Mitigation:
    -  Stay selective with the metrics shown in the statistical analysis.

## Complecity of User Interaction Onto the Environment

Users should be able to easily interact with the simulation in a meaningful way.

- [ ] Users may interact with specific points on a lane
- [ ] Users may set simple traffic rules on some lanes
- [ ] Users may set restrictions on a chosen agent type
- [ ] The buildings of public interest, ones that will see more visitors, should be labelled on the map.

### Risk Assessment

The risks for this section are neither high impact nor high likelihood.
 
 ## Simulation Complete

 A complete simulation should fulfil all criteria agreed with the client and be ready for handover.

- [ ] The simulation is finished and should fulfil all criteria agreed with the client.
- [ ] The simulation is ready for handover.

### Risk Assessment

**Slow to Run**
- Impact: *High*
    - The simulation should run fast, as a slow / laggy simulation will be difficult to use from an end user standpoint.
- Likelihood: *Medium*
    - It is a possibility that given all the different parts of the simulation that it will not run very fast.
- Mitigation:
    - The milestone has been set for a few weeks before the due date, so some extra time is available to fix any speed problems.

**Incomplete Simulation**
- Impact: *High*
    - The simulation should be fully implemented as per the criteria agreed with the client, so if it is not, this is a critical failure.
- Likelihood: *Low*
    - There is a small chance that some implementation turns out to be impossible/will take too long.
- Mitigation:
    - The milestone has been set for a few weeks before the due date, so some extra time is available to fix any speed problems.
    - Make sure to constantly communicate what is possible with the client as the project continues
 
## Final Presentation

- [ ] A final presentation should be produced in PowerPoint or other similar software.
- [ ] A demonstration should come along with this presentation.
- [ ] All group members have something to say in the presentation (if they want to).

### Risk Assessment

The risks for this section are neither high impact nor high likelihood.

       
[^1]: [Car Driving: Junctions - Safe Driving for Life](https://www.safedrivingforlife.info/advice/car-driving/develop-practical-driving-skills/car-driving-junctions/) (Accessed on October 26, 2023)
[^2]: Dijkstra, E. W. (1959). A note on two problems in connexion with graphs. Numerische Mathematik, 1(1), 269-271.
